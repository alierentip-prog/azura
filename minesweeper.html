<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azura | Mayın Tarlası</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;600;800&family=JetBrains+Mono:wght@500&display=swap" rel="stylesheet">
    
    <style>
        :root { 
            --bg-mesh: linear-gradient(135deg, #f0f9ff 0%, #fdf2f8 100%);
            --p-rose: #f43f5e;
            --p-indigo: #6366f1;
            --cell-bg: #e2e8f0;
            --cell-revealed: #f8fafc;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: var(--bg-mesh); 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            min-height: 100vh; display: flex; align-items: center; justify-content: center;
        }

        .game-perde {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(25px);
            padding: 50px;
            border-radius: 60px;
            border: 2px solid #fff;
            box-shadow: 0 40px 100px rgba(0,0,0,0.05);
            text-align: center;
            max-width: 600px;
            width: 95%;
        }

        .header { margin-bottom: 30px; }
        .game-title { font-size: 2.5rem; font-weight: 800; color: #1e293b; letter-spacing: -2px; }
        
        .stats-bar { 
            display: flex; justify-content: center; gap: 30px; 
            margin-bottom: 30px; font-family: 'JetBrains Mono'; font-weight: 800;
        }
        .stat-item { background: #fff; padding: 10px 20px; border-radius: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.02); }

        /* MAYIN TARLASI IZGARASI */
        #grid {
            display: grid;
            grid-template-columns: repeat(10, 40px);
            grid-template-rows: repeat(10, 40px);
            gap: 6px;
            justify-content: center;
            margin: 0 auto;
        }

        .cell {
            width: 40px; height: 40px;
            background: var(--cell-bg);
            border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
            font-weight: 800; font-size: 1.2rem;
            cursor: pointer; transition: 0.2s;
            user-select: none;
        }

        .cell:hover { background: #cbd5e1; transform: scale(1.05); }
        .cell.revealed { background: var(--cell-revealed); cursor: default; transform: none; box-shadow: inset 0 2px 5px rgba(0,0,0,0.05); }
        .cell.mine { background: var(--p-rose) !important; color: #fff; }
        .cell.flag { color: var(--p-rose); }

        /* SAYILAR İÇİN RENKLER */
        .n-1 { color: #3b82f6; } .n-2 { color: #10b981; } .n-3 { color: #ef4444; }
        .n-4 { color: #8b5cf6; } .n-5 { color: #f59e0b; }

        .controls { margin-top: 40px; }
        .btn-reset { 
            background: var(--p-indigo); color: #fff; border: none; 
            padding: 15px 40px; border-radius: 50px; font-weight: 800; 
            cursor: pointer; transition: 0.3s;
        }
        .btn-reset:hover { transform: translateY(-3px); box-shadow: 0 15px 30px rgba(99,102,241,0.3); }

        .back-link { display: block; margin-top: 25px; text-decoration: none; color: #64748b; font-weight: 600; font-size: 0.9rem; }
    </style>
</head>
<body>

    <div class="game-perde">
        <div class="header">
            <h1 class="game-title">Mayın Tarlası</h1>
            <p style="color: #64748b; margin-top: 5px;">Risk yönetimi ve mantıksal çıkarım simülasyonu.</p>
        </div>

        <div class="stats-bar">
            <div class="stat-item">MAYIN: <span id="mine-count" style="color: var(--p-rose);">15</span></div>
            <div class="stat-item">SÜRE: <span id="timer" style="color: var(--p-indigo);">0</span>s</div>
        </div>

        <div id="grid"></div>

        <div class="controls">
            <button class="btn-reset" onclick="initGame()">YENİDEN BAŞLAT</button>
            <a href="games.html" class="back-link"><i class="fa-solid fa-arrow-left"></i> Laboratuvara Dön</a>
        </div>
    </div>

    <script>
        const size = 10;
        const minesCount = 15;
        let board = [];
        let revealedCount = 0;
        let isGameOver = false;
        let timer = 0;
        let timerInterval;

        function initGame() {
            const grid = document.getElementById('grid');
            grid.innerHTML = '';
            board = [];
            revealedCount = 0;
            isGameOver = false;
            clearInterval(timerInterval);
            timer = 0;
            document.getElementById('timer').innerText = timer;
            document.getElementById('mine-count').innerText = minesCount;

            // Boş tahta oluştur
            for (let i = 0; i < size * size; i++) {
                board.push({
                    isMine: false,
                    isRevealed: false,
                    isFlagged: false,
                    neighborMines: 0
                });
            }

            // Mayınları yerleştir
            let minesPlaced = 0;
            while (minesPlaced < minesCount) {
                let index = Math.floor(Math.random() * (size * size));
                if (!board[index].isMine) {
                    board[index].isMine = true;
                    minesPlaced++;
                }
            }

            // Komşu sayılarını hesapla
            for (let i = 0; i < size * size; i++) {
                if (board[i].isMine) continue;
                let count = 0;
                let neighbors = getNeighbors(i);
                neighbors.forEach(n => {
                    if (board[n].isMine) count++;
                });
                board[i].neighborMines = count;
            }

            // Hücreleri çiz
            board.forEach((cell, i) => {
                const cellEl = document.createElement('div');
                cellEl.classList.add('cell');
                cellEl.dataset.index = i;
                
                cellEl.addEventListener('click', () => revealCell(i));
                cellEl.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    toggleFlag(i);
                });
                
                grid.appendChild(cellEl);
            });

            startTimer();
        }

        function getNeighbors(index) {
            let n = [];
            let x = index % size;
            let y = Math.floor(index / size);

            for (let offY = -1; offY <= 1; offY++) {
                for (let offX = -1; offX <= 1; offX++) {
                    if (offX === 0 && offY === 0) continue;
                    let nx = x + offX;
                    let ny = y + offY;
                    if (nx >= 0 && nx < size && ny >= 0 && ny < size) {
                        n.push(ny * size + nx);
                    }
                }
            }
            return n;
        }

        function revealCell(index) {
            if (isGameOver || board[index].isRevealed || board[index].isFlagged) return;

            const cell = board[index];
            const cellEl = document.querySelectorAll('.cell')[index];
            
            cell.isRevealed = true;
            cellEl.classList.add('revealed');

            if (cell.isMine) {
                gameOver(false);
                return;
            }

            revealedCount++;

            if (cell.neighborMines > 0) {
                cellEl.innerText = cell.neighborMines;
                cellEl.classList.add('n-' + cell.neighborMines);
            } else {
                // Boş hücre ise komşuları aç
                let neighbors = getNeighbors(index);
                neighbors.forEach(n => revealCell(n));
            }

            if (revealedCount === size * size - minesCount) {
                gameOver(true);
            }
        }

        function toggleFlag(index) {
            if (isGameOver || board[index].isRevealed) return;
            const cell = board[index];
            const cellEl = document.querySelectorAll('.cell')[index];

            cell.isFlagged = !cell.isFlagged;
            cellEl.innerHTML = cell.isFlagged ? '<i class="fa-solid fa-flag"></i>' : '';
            cellEl.classList.toggle('flag');
        }

        function gameOver(isWin) {
            isGameOver = true;
            clearInterval(timerInterval);
            
            board.forEach((cell, i) => {
                if (cell.isMine) {
                    const cellEl = document.querySelectorAll('.cell')[i];
                    cellEl.classList.add('mine');
                    cellEl.innerHTML = '<i class="fa-solid fa-bomb"></i>';
                }
            });

            setTimeout(() => {
                alert(isWin ? "TEBRİKLER! Tüm mayınları temizlediniz." : "OYUN BİTTİ! Bir mayına bastınız.");
            }, 100);
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                timer++;
                document.getElementById('timer').innerText = timer;
            }, 1000);
        }

        initGame();
    </script>
</body>
</html>
